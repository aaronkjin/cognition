# Memory: FIND-0014 â€” Unencrypted Password Reset Tokens

## Metadata
- **Category**: missing_encryption
- **Service**: user-service
- **Severity**: high
- **Outcome**: SUCCESS
- **Confidence**: high
- **Data Source**: live
- **Run ID**: dff62097
- **Created**: 2026-02-24T03:40:21.640033+00:00

## Fix Approach
Hash password reset tokens using SHA-256 (hashlib.sha256) before storing in database. Tokens only need equality checks (user submits token, we hash it and compare against stored hash). No env var needed since SHA-256 is a deterministic hash. Add hash_reset_token() and verify_reset_token() utilities. Updated User.set_reset_token to store hashed token and added note about one-time migration for existing plaintext tokens.

## Files Modified
- `app/models/user.py`
- `tests/test_reset_token.py`

## Test Results
- **Tests Passed**: Yes
- **Tests Added**: 9

## PR
https://github.com/aaronkjin/coupang-user-service/pull/21

## Error
No errors.
